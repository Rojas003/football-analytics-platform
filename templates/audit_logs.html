{% extends "base.html" %}

{% block title %}Audit Logs{% endblock %}

{% block content %}
<h2>ðŸ“‹ Audit Logs</h2>
<p style="margin-bottom: 20px;">System activity and security monitoring (Last 100 entries).</p>

<div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
    <strong>ðŸ”’ Security Notice:</strong> All sensitive actions are logged for compliance and security auditing.
</div>

<table>
    <thead>
        <tr>
            <th>Timestamp</th>
            <th>User</th>
            <th>Action</th>
            <th>Details</th>
            <th>IP Address</th>
        </tr>
    </thead>
    <tbody>
        {% if logs %}
            {% for log in logs %}
            <tr>
                <td>{{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>
                    {% if log.user_id %}
                        <span style="font-weight: 500;">User #{{ log.user_id }}</span>
                    {% else %}
                        <span style="color: #999;">Anonymous</span>
                    {% endif %}
                </td>
                <td>
                    {% if 'login' in log.action %}
                        <span class="badge badge-success">{{ log.action }}</span>
                    {% elif 'failed' in log.action or 'delete' in log.action %}
                        <span class="badge badge-danger">{{ log.action }}</span>
                    {% elif 'added' in log.action or 'registered' in log.action %}
                        <span class="badge badge-info">{{ log.action }}</span>
                    {% else %}
                        <span class="badge badge-default">{{ log.action }}</span>
                    {% endif %}
                </td>
                <td style="max-width: 300px; white-space: normal; font-size: 14px;">
                    {{ log.details if log.details else '-' }}
                </td>
                <td style="font-family: monospace; font-size: 13px;">
                    {{ log.ip_address if log.ip_address else '-' }}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="5" style="text-align: center; padding: 40px; color: #999;">
                    No audit logs available.
                </td>
            </tr>
        {% endif %}
    </tbody>
</table>

<style>
    .badge {
        padding: 4px 10px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
    }
    
    .badge-success {
        background: #d4edda;
        color: #155724;
    }
    
    .badge-danger {
        background: #f8d7da;
        color: #721c24;
    }
    
    .badge-info {
        background: #d1ecf1;
        color: #0c5460;
    }
    
    .badge-default {
        background: #e2e3e5;
        color: #383d41;
    }
</style>

<div style="margin-top: 30px; background: #f8f9fa; padding: 20px; border-radius: 10px;">
    <h3 style="margin-bottom: 10px;">Logged Actions Include:</h3>
    <ul style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; list-style-position: inside; font-size: 14px;">
        <li>User login/logout events</li>
        <li>Failed login attempts</li>
        <li>User registration</li>
        <li>Role changes</li>
        <li>Player additions</li>
        <li>Stats additions/edits</li>
        <li>Life event additions/edits</li>
        <li>Data deletions</li>
    </ul>
</div>

<div style="margin-top: 30px;">
    <a href="{{ url_for('admin_users') }}" class="btn btn-secondary">Back to User Management</a>
    <a href="/" class="btn">Dashboard</a>
</div>
{% endblock %}